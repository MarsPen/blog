### 问题1：
看你的简历里提到了BFF，那么你们团队BFF是怎么分工的呢？
### 回答：

### 问题2：
嗯 你也说了要给BFF提供负载均衡。你们怎么做的呢？你们团队的QPS大概多少？
### 回答：

### 问题3:
刚才说到了Nginx,那么Nginx在负载的第几层？
### 回答：

四层/七层负载均衡
OSI网络模型共分为七层，即从用户发起请求到服务器接收需要经过七道工序。七层从上往下分别是应用层、表示层、会话层、传输层、网络层、数据链路层、物理层。

所谓负载均衡分层，与OSI七层模型相对应。其中七层负载均衡是指Nginx在应用层提供服务，四层表示Nginx在传输层提供服务。

- 四层负载均衡
四层负载均衡是基于IP+端口的负载均衡，原理是通过转发请求到后台的服务器，它只负责转发并且会记录当前连接是由哪个服务器处理的，后续这个连接的请求就由同一台服务器去处理，其实就是相当于长连接，这个长连接一旦打开就会一直处理连接的状态，它的性能就会非常的高了，四层是基于传输层的，主要基于tcp和udp。

  - F5硬负载均衡：商业级别，很贵
  - LVS四层负载均衡：它是Linux内核的负载，和协议没什么关系，主要是负责转发一些 请求的，它是基于CS端的
  - HA proxy四层负载均衡：同样支持转发功能，并且灵活性非常高，除了做四层以外也能够做七层的负载均衡
  - Nginx 四层负载均衡：既可以做负载均衡也可以做七层负载均衡，可以用于实现四层协议的转发、代理等等

- 七层负载均衡
  - 是基于URL或IP的负载均衡，是基于应用层的，是针对http协议的一个负载均衡。
  - nginx七层负载均衡 对http协议或者邮箱协议做负载均衡，性能强劲
  - Haproxy 七层负载均衡 灵活性很高
  - apache七层负载均衡协议 灵活性不高，并发达到百万级的话性能会非常地差

总结：

四层做负载一般会使用LVS，Nginx更适合做七层负载。
四层负载均衡主要适用于处理基于tcp、udp协议，重点是用于转发请求，并不是处理请求；七层一般用于处理http协议的，适用于web服务器；七层是会处理请求的，比如它可以去处理静态资源的一些内容，可以进行压缩或者缓存。

- DNS地域负载均衡
由DNS服务器来识别，根据IP地址采用就近原则访问最近的服务器。


### QPS 相关概念

每秒查询率 QPS：对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准，即每秒请求数，即最大谈吐能力。

并发数：并发数和 QPS 是不同的概念，一般说 QPS 会说多少并发用户下 QPS，当 QPS 相同时，并发用户数越大，网站并发处理能力越好。当并发用户数过大时，会造成进程（线程）频繁切换，反正真正用于处理请求的时间变少，每秒能够处理的请求数反而变少，同时用户的请求等待时间也会变大。 找到最佳线程数能够让 web 系统更稳定，效率更高。
 
通过 QPS 和 pv 计算部署服务器台数： 

单台服务器每天 PV 计算
- 公式 1：每天总 PV = QPS * 3600 * 6
- 公式 2：每天总 PV = QPS * 3600 * 8

峰值 QPS 和机器计算公式
- 原理：每天 80% 的访问集中在 20% 的时间里，这 20% 时间叫做峰值时间
- 公式：(总 PV 数 * 80%) / ( 每天秒数 * 20% ) = 峰值时间每秒请求数 (QPS)
- 机器：峰值时间每秒 QPS / 单台机器的 QPS   = 需要的机器

例子
- 问：每天 300w PV 的在单台机器上，这台机器需要多少 QPS？
- 答：(3000000 * 0.8) / (86400 * 0.2 ) = 139 (QPS) 

- 问：如果一台机器的 QPS 是 58，需要几台机器来支持？
- 答：139 / 58 = 3


